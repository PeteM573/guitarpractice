<!DOCTYPE html>
<html>
<head>
    <title>Guitar Practice Thing</title>
    <script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>
    <link rel="stylesheet" href="style.css"> <!-- Link to external CSS -->
</head>
<body>
    <h1>Guitar Practice Thing</h1>

    <!-- Phase 1: Selection -->
    <div id="selectionPhase">
        <h2>1. Select Key</h2>
        <!-- Circle of Fifths will go here -->
        <div id="circleContainer">
             <svg id="circleOfFifths" width="300" height="300" viewBox="0 0 100 100">
                <!-- SVG content will be added by JS -->
             </svg>
        </div>

        <h2>2. Select Progression</h2>
        <div class="control-group">
            <label for="progressionSelect">Progression:</label>
            <select id="progressionSelect">
                <!-- Options populated by JS -->
            </select>
        </div>

        <h2>3. Set Tempo & Start</h2>
        <div class="tempo-control control-group">
            <label for="tempoSlider">Tempo:</label>
            <input type="range" id="tempoSlider" min="60" max="240" value="120" step="1">
            <span id="tempoValue">120</span> BPM
            <!-- === START: New Metronome Elements === -->
            <button id="metronomeToggle" style="margin-left: 20px;">Metronome OFF</button>
            <!-- === END: New Metronome Elements === -->
        </div>
        <!-- === START: New Fretboard View Controls === -->
        <div class="control-group fretboard-controls">
            <label>Fretboard View:</label>
            <div class="radio-group">
                <input type="radio" id="fretViewFixed" name="fretViewMode" value="fixed">
                <label for="fretViewFixed">Fixed (0-11)</label>

                <input type="radio" id="fretViewSliding" name="fretViewMode" value="sliding" checked> <!-- Default -->
                <label for="fretViewSliding">Sliding Window</label>

                <input type="radio" id="fretViewRandom" name="fretViewMode" value="random">
                <label for="fretViewRandom">Random Window</label>
            </div>
             <div id="slidingStartFretControl" class="sub-control"> <!-- Initially shown as sliding is default -->
                 <label for="startFretInput">Start Fret:</label>
                 <input type="number" id="startFretInput" min="0" max="19" value="0" step="1">
             </div>
        </div>
        <!-- === END: New Fretboard View Controls === -->
        <div>
            <button id="startButton">Start Practice</button>
        </div>
    </div>

    <!-- Phase 2: Lesson / Practice -->
    <div id="lessonPhase" class="hidden"> <!-- Initially hidden -->
         <h2>Practice Session</h2>
         <p>Playing: <span id="lessonInfo">...</span></p>

         <!-- Waveform Display Area -->
         <div id="waveformContainer">
             <canvas id="waveformCanvas" width="600" height="100"></canvas>
         </div>

         <!-- Legend Container Area -->
         <div id="legendContainer">
            <div class="legend-item">
                <span class="legend-color legend-color-out"></span>
                <span class="legend-label">Out of Key</span>
            </div>
            <div class="legend-item">
                <span class="legend-color legend-color-in"></span>
                <span class="legend-label">In Key</span>
            </div>
        </div>

        <!-- Fretboard Display Area -->
        <div id="fretboardContainer">
            <svg id="fretboardSVG" viewBox="0 0 600 150">
               <!-- SVG content will be generated by JS -->
            </svg>
            <div id="fretboardInfo">Starting Fret: 0</div> <!-- Simple indicator for now -->
        </div>
        <!-- End Fretboard Display Area -->

        
         <!-- Pitch Output Area -->
         <div id="pitchOutput">
             Pitch Info Will Appear Here
         </div>

         <div class="control-group">
             <button id="stopButton">Stop Practice</button>
         </div>
    </div>

    <script src="script.js" type="module"></script>
</body>
</html>